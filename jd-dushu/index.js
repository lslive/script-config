/**
Title: 京东读书 签到打卡
Nomination / Category: QuanmuteX
Written by: lslive
Date: 2025-09-12
Draft Version: 0.1
Contact Info: https://github.com/lslive
Notes: 只测试过圈X，其它环境请自行尝试
*/

var _0xodI='jsjiami.com.v7';const _0x3c7e0f=_0x58b0;(function(_0x31c004,_0x38578e,_0x29b586,_0x35a479,_0x5618f1,_0x1234d0,_0x4f05d3){return _0x31c004=_0x31c004>>0x7,_0x1234d0='hs',_0x4f05d3='hs',function(_0x18e885,_0x26764c,_0x1acedb,_0x12a3dc,_0x513fc2){const _0x4f4776=_0x58b0;_0x12a3dc='tfi',_0x1234d0=_0x12a3dc+_0x1234d0,_0x513fc2='up',_0x4f05d3+=_0x513fc2,_0x1234d0=_0x1acedb(_0x1234d0),_0x4f05d3=_0x1acedb(_0x4f05d3),_0x1acedb=0x0;const _0xe3580e=_0x18e885();while(!![]&&--_0x35a479+_0x26764c){try{_0x12a3dc=-parseInt(_0x4f4776(0xc7,'OKIf'))/0x1*(-parseInt(_0x4f4776(0x101,'F&z$'))/0x2)+parseInt(_0x4f4776(0x106,'F&z$'))/0x3*(-parseInt(_0x4f4776(0xf2,'8Dxv'))/0x4)+-parseInt(_0x4f4776(0xc8,']j&A'))/0x5*(parseInt(_0x4f4776(0xf5,'Mn8H'))/0x6)+parseInt(_0x4f4776(0xd7,'^I6g'))/0x7*(-parseInt(_0x4f4776(0xe3,'n74G'))/0x8)+parseInt(_0x4f4776(0xb7,'PNw('))/0x9*(-parseInt(_0x4f4776(0xe5,'7uMb'))/0xa)+-parseInt(_0x4f4776(0xed,'&l%T'))/0xb*(-parseInt(_0x4f4776(0xe0,')s3i'))/0xc)+parseInt(_0x4f4776(0xe2,'86OO'))/0xd*(parseInt(_0x4f4776(0xf1,'*O[K'))/0xe);}catch(_0x442800){_0x12a3dc=_0x1acedb;}finally{_0x513fc2=_0xe3580e[_0x1234d0]();if(_0x31c004<=_0x35a479)_0x1acedb?_0x5618f1?_0x12a3dc=_0x513fc2:_0x5618f1=_0x513fc2:_0x1acedb=_0x513fc2;else{if(_0x1acedb==_0x5618f1['replace'](/[eULGdREkgMuxOBIrNnwX=]/g,'')){if(_0x12a3dc===_0x26764c){_0xe3580e['un'+_0x1234d0](_0x513fc2);break;}_0xe3580e[_0x4f05d3](_0x513fc2);}}}}}(_0x29b586,_0x38578e,function(_0x5d088c,_0xe1d4ff,_0x1944dc,_0x34487a,_0x30a11f,_0x19a79b,_0x1f85db){return _0xe1d4ff='\x73\x70\x6c\x69\x74',_0x5d088c=arguments[0x0],_0x5d088c=_0x5d088c[_0xe1d4ff](''),_0x1944dc='\x72\x65\x76\x65\x72\x73\x65',_0x5d088c=_0x5d088c[_0x1944dc]('\x76'),_0x34487a='\x6a\x6f\x69\x6e',(0x1bab47,_0x5d088c[_0x34487a](''));});}(0x6500,0x1c392,_0x2748,0xcc),_0x2748)&&(_0xodI=0xcc);function _0x58b0(_0x5d3b34,_0x3c0417){const _0x27482d=_0x2748();return _0x58b0=function(_0x58b09a,_0x4493df){_0x58b09a=_0x58b09a-0xb2;let _0x31d0dc=_0x27482d[_0x58b09a];if(_0x58b0['LPETHS']===undefined){var _0x47c577=function(_0x2e87fb){const _0xbca1c8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x32a3e7='',_0x409e4e='';for(let _0x31f02a=0x0,_0x2996aa,_0x12b2c8,_0x20bf10=0x0;_0x12b2c8=_0x2e87fb['charAt'](_0x20bf10++);~_0x12b2c8&&(_0x2996aa=_0x31f02a%0x4?_0x2996aa*0x40+_0x12b2c8:_0x12b2c8,_0x31f02a++%0x4)?_0x32a3e7+=String['fromCharCode'](0xff&_0x2996aa>>(-0x2*_0x31f02a&0x6)):0x0){_0x12b2c8=_0xbca1c8['indexOf'](_0x12b2c8);}for(let _0x306813=0x0,_0x195c52=_0x32a3e7['length'];_0x306813<_0x195c52;_0x306813++){_0x409e4e+='%'+('00'+_0x32a3e7['charCodeAt'](_0x306813)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x409e4e);};const _0x42081e=function(_0x126352,_0x49784d){let _0x1ad8a6=[],_0x40253a=0x0,_0x25d29c,_0x5d3d85='';_0x126352=_0x47c577(_0x126352);let _0x3f7c12;for(_0x3f7c12=0x0;_0x3f7c12<0x100;_0x3f7c12++){_0x1ad8a6[_0x3f7c12]=_0x3f7c12;}for(_0x3f7c12=0x0;_0x3f7c12<0x100;_0x3f7c12++){_0x40253a=(_0x40253a+_0x1ad8a6[_0x3f7c12]+_0x49784d['charCodeAt'](_0x3f7c12%_0x49784d['length']))%0x100,_0x25d29c=_0x1ad8a6[_0x3f7c12],_0x1ad8a6[_0x3f7c12]=_0x1ad8a6[_0x40253a],_0x1ad8a6[_0x40253a]=_0x25d29c;}_0x3f7c12=0x0,_0x40253a=0x0;for(let _0x4610f2=0x0;_0x4610f2<_0x126352['length'];_0x4610f2++){_0x3f7c12=(_0x3f7c12+0x1)%0x100,_0x40253a=(_0x40253a+_0x1ad8a6[_0x3f7c12])%0x100,_0x25d29c=_0x1ad8a6[_0x3f7c12],_0x1ad8a6[_0x3f7c12]=_0x1ad8a6[_0x40253a],_0x1ad8a6[_0x40253a]=_0x25d29c,_0x5d3d85+=String['fromCharCode'](_0x126352['charCodeAt'](_0x4610f2)^_0x1ad8a6[(_0x1ad8a6[_0x3f7c12]+_0x1ad8a6[_0x40253a])%0x100]);}return _0x5d3d85;};_0x58b0['BHMMTo']=_0x42081e,_0x5d3b34=arguments,_0x58b0['LPETHS']=!![];}const _0x456ac5=_0x27482d[0x0],_0x196302=_0x58b09a+_0x456ac5,_0x2ff1d3=_0x5d3b34[_0x196302];return!_0x2ff1d3?(_0x58b0['sYigfz']===undefined&&(_0x58b0['sYigfz']=!![]),_0x31d0dc=_0x58b0['BHMMTo'](_0x31d0dc,_0x4493df),_0x5d3b34[_0x196302]=_0x31d0dc):_0x31d0dc=_0x2ff1d3,_0x31d0dc;},_0x58b0(_0x5d3b34,_0x3c0417);}const $=new Env(_0x3c7e0f(0xfe,')s3i')),ckName='JD-DS-CK';let userCookie=$[_0x3c7e0f(0xfb,'YzFM')](ckName);async function sign(){const _0x2b7e76=_0x3c7e0f,_0x292f10={'eKCkD':function(_0x54e870,_0x44b905){return _0x54e870===_0x44b905;},'JuRlX':_0x2b7e76(0xda,'1#7F'),'zQCGQ':_0x2b7e76(0xf7,'3)$z'),'adAUm':'xtZLS'},_0x4bd885='https://jdread-api.jd.com/jdread/api/activity/sign?eventFrom=1&build=202506302&client=iphone&cv=4.40.3&dv=JO2f9R0kdn1L3caoJu4eTL%2FJESnNH33ebsPC%2F7Z%2Fu5OXRj1N2cyFpzVa2%2FLFs3r%2F&ec=onqcIH9nmO%2FNOHfbVHb%2FotCICg5UcRNjX4RVABkJ3nM8AuNT4Jgg14tUF4rF2eQ7N5YXibn9Th1poIoqxbblg7nWSf%2FxFRijAeNDn9ffLSCM%2FvxnWj2pLUZEl7GTsY7LORh1rlgTNjkQR0fmdvX3ljQKLSz6vqwQQD754uXCZfeYwl2QtD1sCPaj8R564Qld%2BxV8K632vQ2rDBqQ%2FQHacg&naviHeight=44&os=ios&statusHeight=59&suid=iphone&tm=1757588056646&uid=iphone&app=jdread-m&encdv=1&sign=59dc635a6ec146fda799ac79ea95209c',_0x431699={'Sec-Fetch-Dest':'empty','Connection':_0x2b7e76(0xb5,'n74G'),'Accept-Encoding':_0x2b7e76(0xc4,'PNw('),'isencrypt':_0x2b7e76(0xc6,')o8u'),'Content-Type':_0x2b7e76(0xec,'PNw('),'Sec-Fetch-Site':'same-origin','Origin':_0x2b7e76(0xb2,']j&A'),'Sec-Fetch-Mode':_0x2b7e76(0xbe,'*O[K'),'Host':_0x2b7e76(0x104,'uayo'),'Referer':'https://jdread-api.jd.com/h5/p_sign_in?eventFrom=1&app=jdread-app&build=202506302&client=iphone&cv=4.40.3&dv=W9l7_y_RY1qxpFR8ttiVRNHQ14dksnCTYF7W93_xDcKQkrO3PxeD-t_St5xxeM2p&ec=4RqUxAYZE8I4Uu4mUzSLU%2FOBL99hswLD2kZ9yLUUNKXTyHL%2Bw%2Fhf%2BriQEljMsLURcYK8kMU9FthBkKWiGOv55DH7UOWYLlqTGbJcqiJN2UZOSoQ1tQi3mos%2BAY5JPiZyGUHPSRYcUNlcayddr%2FLjsJl4wPzzP3Yhr2%2FW27Lil5odLmVfo6Luhg71B4mJySg2Q3q6j1cB3ztQT9J75H5lqA%3D%3D&naviHeight=44&os=ios&statusHeight=59&suid=iphone&tm=1757588055676&uid=iphone','Accept-Language':_0x2b7e76(0xc1,'i(HP'),'Accept':'application/json',...userCookie},_0x329fbc=$['time'](_0x2b7e76(0xcb,'PNw(')),_0x598624=_0x2b7e76(0xd3,'3)$z')+_0x329fbc+'\x22,\x22sign_type\x22:0}';try{const _0x42d1e5=await $[_0x2b7e76(0xe1,'OKIf')][_0x2b7e76(0xf3,'C&$U')]({'url':_0x4bd885,'headers':_0x431699,'body':_0x598624});if(_0x292f10[_0x2b7e76(0xce,'QVnS')](_0x42d1e5[_0x2b7e76(0xd2,']j&A')],0xc8)){if(_0x292f10[_0x2b7e76(0xdf,'C&$U')]===_0x292f10[_0x2b7e76(0xd8,'%e]*')]){const _0x3e2210=JSON[_0x2b7e76(0xd1,'^LDj')](_0x42d1e5[_0x2b7e76(0xee,'8Dxv')]);console['log'](_0x3e2210),$[_0x2b7e76(0xcd,'YzFM')](_0x2b7e76(0xeb,'uayo')+_0x3e2210[_0x2b7e76(0xe7,'7uMb')]+_0x2b7e76(0xd6,'^I6g')+(_0x3e2210?.[_0x2b7e76(0xd0,'WNpm')]?.[_0x2b7e76(0xf8,'v#DM')]?.[_0x2b7e76(0xdb,'z!K$')]||0x0));}else _0x1cb5df[_0x2b7e76(0xe4,'BHjN')](null,_0x1aa749);}else _0x292f10['zQCGQ']===_0x292f10[_0x2b7e76(0xea,'PNw(')]?_0x58e413[_0x2b7e76(0xbf,'#Rh2')]():$[_0x2b7e76(0xb3,')s3i')]('⚠️\x20请求失败:\x20'+_0x42d1e5[_0x2b7e76(0xb6,'1#7F')]+'\x0a'+_0x42d1e5[_0x2b7e76(0xbb,'*O[K')]);}catch(_0x13ca5){$[_0x2b7e76(0xca,'@wPa')]('❌\x20请求错误\x20请更新CK:\x20'+_0x13ca5),await delectCK();}}async function getCookie(){const _0x274f93=_0x3c7e0f,_0x3224ce={'ZrWWh':function(_0x31abd4,_0x3bf871){return _0x31abd4!=_0x3bf871;},'XSiTi':_0x274f93(0xfc,']WBY'),'KmPtJ':'Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2018_5\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Mobile/15E148','cxHut':_0x274f93(0xb8,'WNpm'),'IMWXX':_0x274f93(0xe9,'5q8r')};if($request&&_0x3224ce[_0x274f93(0xbd,'PNw(')]($request[_0x274f93(0xcf,'v#DM')],_0x3224ce[_0x274f93(0x105,'mX%8')])){const _0x3b057a=$request[_0x274f93(0xe6,'BHjN')][_0x274f93(0xc2,'3QT8')]||_0x3224ce['KmPtJ'],_0x7a30c0=$request[_0x3224ce['cxHut']]['Cookie'],_0x146acd=$request[_0x3224ce[_0x274f93(0xfa,'i(HP')]][_0x3224ce[_0x274f93(0xd4,'YzFM')]];$[_0x274f93(0xe4,'BHjN')]({'User-Agent':_0x3b057a,'Cookie':_0x7a30c0,'reqtime':_0x146acd},ckName),$['msg']($['name'],'',_0x274f93(0xf0,'w6So'));}$[_0x274f93(0xff,'A5jl')]();}async function delectCK(){const _0xed2481=_0x3c7e0f;$[_0xed2481(0xc0,'7uMb')](null,ckName);}function _0x2748(){const _0x3b4c41=(function(){return[_0xodI,'NLRjrsUOjuiNeagdmXiEI.xckMoMnMm.NBvI7wEG==','lSk5sIP8bCkl','W7SyxHzr','WOxcNHHd','WQfNqLS','W6GZb2OdW6RdHW','WPjlW7FdJmonDH3dJvGyFIZdT8kgW6/dN8o3oCo9','bhpcTqZdRSkrW53cPCkuW6G','W7e4vxhcJh3cKCkS','W4yqydevksVcO0yCW4VcIhKCW6r4W6m','gSkRWQmSW4m','lSohWOLIWQq','rdFdL8kmnCkvaCkJumkj','W45MW6NcKcBdSSosgafTqmkR','WPNcP2XBW7W5WRC5W4ZcNCop','W4CKFW','W5GtCdGuraldQ0qu','WORcNG0','wmk9rG','FgraWRhcRq','cSojsaRdSsi','ECkpW70K','omkXvJH1','WOWHWRRdLgFcSCoYid9n','W5tdUIernCokFsueiMOWWRZdNKyrhYmi','FmkdDSkdWOq','W4GuhfG7','moENLEwkLo+8Ra','j0ldUvxcSbSn'].concat((function(){return['kSkSW6u3WPe','lu/cL3tcVCkKsYJdPq','lSold23dJq','oSkmWOuHW5BcSmoF','WP/cUYv4ha','ArldH2JcLCk5CHFdTG','W4yhW5XNWO45WPO','xrxcNmoOWQW','d8oIlmopW4hdR8kUkXW','hNlcKSon','fMvpdf7cN8kiW74','W6HMW47cSJ7dL8kcW7agW47cHSkb','j8k1tSoBgJG/','WQ1HrJDgWRxdGK/cGcJdMeu','pmk1w8ovdcuI','W7yZahmrW6ldJa','W58mW5X7WP4','W5ddLYRcN8oDWPib','W4aosbru','4P6/W6tORy/MSAxMIjVLI4ZcQmoh','W4aAEs1qAI7cSKKFW4tdK3zdWQT0','l3zNCGDtdu9OWPbu','WQuWW4dcRa','WOTSdLSjjCovWOFdLCocxmoM','6iYB5y2j56YQ5yMtWO4+WOitW7lcSoAkTEwiGVczViq','W5FdGv4auKpdH8kngSkYySkAbG','W7nVW53cMG/dTSkInq','zW/cVCoW','bJ7cUa','WOS6wH5iy8om'].concat((function(){return['bslcQ8opa1D3wmo0','W77cQqm8fa','a8onsam','W6JdNWpcS8oN','WOTBWPldUSo3','uSkRvCkXWQ/cGuK','bYhdQmk8WOhdTCo6','s3KnW7Ob','5lQq5lUp6k+L5lU8WONNR5pLI5dMIi7LJjm','dYlcSCod','lcy/nejidq','WOPbW5OJlCokW7HmWRi','W5SsW6JdMSoRgcNdKXS','Bgu2W4yv','W5dcOmokqMO3WR/cHSowW48aW5PXq2VcVCkr','WPxcK1nEWPG','WO5kW5zIuSowW7vxWPiuWOa','WPCHWQ/dKghdUmkEydfmqmkbWP5IpXRcNG7cJ8kxW67cQSo9v8oB','umk8Eq','WQlcTqJcLZNcQhm','WRq2WPpdTsxcJSkdW7ezW4a','fmojlg7dStHeASkpcG','WPnDyWLbsHZcLa','DCklW6GHW6q8WPy','rdhcJmo1oCkXnSkD','6i6A5y6G566U5yQWW6xcISonyCooW5RMIOtLIkVWO56x','WOtcNG5j'];}()));}()));}());_0x2748=function(){return _0x3b4c41;};return _0x2748();};(async()=>{const _0x572335=_0x3c7e0f,_0x27060e={'pNFYp':'Mozilla/5.0\x20(iPhone;\x20CPU\x20iPhone\x20OS\x2018_5\x20like\x20Mac\x20OS\x20X)\x20AppleWebKit/605.1.15\x20(KHTML,\x20like\x20Gecko)\x20Mobile/15E148','JmXXS':_0x572335(0xb4,'aj*Z'),'nDXTD':_0x572335(0xde,'SkvH'),'Zkqyj':_0x572335(0xba,'bjom'),'iZLWe':function(_0x335a2d,_0x21c5dc){return _0x335a2d!=_0x21c5dc;},'CHHyp':_0x572335(0xd9,'myVm'),'LkoGD':function(_0x4912df,_0xf410ab){return _0x4912df!==_0xf410ab;},'knqhy':_0x572335(0x103,'[%%N'),'yJOHx':function(_0x36fe38){return _0x36fe38();}};if(_0x27060e['iZLWe'](typeof $request,_0x27060e[_0x572335(0xc5,'z!K$')])){if(_0x27060e['LkoGD'](_0x27060e[_0x572335(0xe8,'SkvH')],_0x572335(0xd5,'7uMb'))){await _0x27060e[_0x572335(0xdc,'*O[K')](getCookie);return;}else{const _0x4a4764=_0x3b082e['headers']['User-Agent']||_0x27060e['pNFYp'],_0x44b43c=_0x4e269a[_0x27060e['JmXXS']]['Cookie'],_0x1ab0a2=_0x488a01[_0x27060e[_0x572335(0xf9,'5q8r')]][_0x27060e[_0x572335(0xfd,'[%%N')]];_0x3b1810[_0x572335(0xe4,'BHjN')]({'User-Agent':_0x4a4764,'Cookie':_0x44b43c,'reqtime':_0x1ab0a2},_0x3b1f9f),_0x276380[_0x572335(0xf4,'A5jl')](_0x5c20d7['name'],'',_0x27060e['Zkqyj']);}}if(!userCookie)return $[_0x572335(0xcc,'*O[K')]('❌请先获取\x20CK');await sign();})()['catch'](_0x264666=>$[_0x3c7e0f(0xf6,'A5jl')]['push'](_0x264666['message']||_0x264666))[_0x3c7e0f(0xbc,'^LDj')](async()=>{$['done']();});var version_ = 'jsjiami.com.v7';


function Env(e,t){class s{constructor(e){this.env=e}send(e,t="GET"){e="string"==typeof e?{url:e}:e;let s=this.get;"POST"===t&&(s=this.post);const i=new Promise(((t,i)=>{s.call(this,e,((e,s,o)=>{e?i(e):t(s)}))}));return e.timeout?((e,t=1e3)=>Promise.race([e,new Promise(((e,s)=>{setTimeout((()=>{s(new Error("请求超时"))}),t)}))]))(i,e.timeout):i}get(e){return this.send.call(this.env,e)}post(e){return this.send.call(this.env,e,"POST")}}return new class{constructor(e,t){this.logLevels={debug:0,info:1,warn:2,error:3},this.logLevelPrefixs={debug:"[DEBUG] ",info:"[INFO] ",warn:"[WARN] ",error:"[ERROR] "},this.logLevel="info",this.name=e,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log("",`🔔${this.name}, 开始!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(e,t=null){try{return JSON.parse(e)}catch{return t}}toStr(e,t=null,...s){try{return JSON.stringify(e,...s)}catch{return t}}getjson(e,t){let s=t;if(this.getdata(e))try{s=JSON.parse(this.getdata(e))}catch{}return s}setjson(e,t){try{return this.setdata(JSON.stringify(e),t)}catch{return!1}}getScript(e){return new Promise((t=>{this.get({url:e},((e,s,i)=>t(i)))}))}runScript(e,t){return new Promise((s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let o=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");o=o?1*o:20,o=t&&t.timeout?t.timeout:o;const[r,a]=i.split("@"),n={url:`http://${a}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:o},headers:{"X-Key":r,Accept:"*/*"},policy:"DIRECT",timeout:o};this.post(n,((e,t,i)=>s(i)))})).catch((e=>this.logErr(e)))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t);if(!s&&!i)return{};{const i=s?e:t;try{return JSON.parse(this.fs.readFileSync(i))}catch(e){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t),o=JSON.stringify(this.data);s?this.fs.writeFileSync(e,o):i?this.fs.writeFileSync(t,o):this.fs.writeFileSync(e,o)}}lodash_get(e,t,s){const i=t.replace(/\[(\d+)\]/g,".$1").split(".");let o=e;for(const e of i)if(o=Object(o)[e],void 0===o)return s;return o}lodash_set(e,t,s){return Object(e)!==e||(Array.isArray(t)||(t=t.toString().match(/[^.[\]]+/g)||[]),t.slice(0,-1).reduce(((e,s,i)=>Object(e[s])===e[s]?e[s]:e[s]=Math.abs(t[i+1])>>0==+t[i+1]?[]:{}),e)[t[t.length-1]]=s),e}getdata(e){let t=this.getval(e);if(/^@/.test(e)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(e),o=s?this.getval(s):"";if(o)try{const e=JSON.parse(o);t=e?this.lodash_get(e,i,""):t}catch(e){t=""}}return t}setdata(e,t){let s=!1;if(/^@/.test(t)){const[,i,o]=/^@(.*?)\.(.*?)$/.exec(t),r=this.getval(i),a=i?"null"===r?null:r||"{}":"{}";try{const t=JSON.parse(a);this.lodash_set(t,o,e),s=this.setval(JSON.stringify(t),i)}catch(t){const r={};this.lodash_set(r,o,e),s=this.setval(JSON.stringify(r),i)}}else s=this.setval(e,t);return s}getval(e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(e);case"Quantumult X":return $prefs.valueForKey(e);case"Node.js":return this.data=this.loaddata(),this.data[e];default:return this.data&&this.data[e]||null}}setval(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(e,t);case"Quantumult X":return $prefs.setValueForKey(e,t);case"Node.js":return this.data=this.loaddata(),this.data[t]=e,this.writedata(),!0;default:return this.data&&this.data[t]||null}}initGotEnv(e){this.got=this.got?this.got:require("got").got,this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.cookie&&void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar)))}get(e,t=(()=>{})){switch(e.headers&&(delete e.headers["Content-Type"],delete e.headers["Content-Length"],delete e.headers["content-type"],delete e.headers["content-length"]),e.params&&(e.url+="?"+this.queryStr(e.params)),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(e),this.got(e).on("redirect",((e,t)=>{try{if(e.headers["set-cookie"]){const s=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),t.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>{const{statusCode:i,statusCode:o,headers:r,rawBody:a}=e,n=s.decode(a,this.encoding);t(null,{status:i,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:i,response:o}=e;t(i,o,o&&s.decode(o.rawBody,this.encoding))}));break}}post(e,t=(()=>{})){const s=e.method?e.method.toLocaleLowerCase():"post";switch(e.body&&e.headers&&!e.headers["Content-Type"]&&!e.headers["content-type"]&&(e.headers["content-type"]="application/x-www-form-urlencoded"),e.headers&&(delete e.headers["Content-Length"],delete e.headers["content-length"]),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":e.method=s,this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let i=require("iconv-lite");this.initGotEnv(e);const{url:o,...r}=e;this.got[s](o,r).then((e=>{const{statusCode:s,statusCode:o,headers:r,rawBody:a}=e,n=i.decode(a,this.encoding);t(null,{status:s,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:s,response:o}=e;t(s,o,o&&i.decode(o.rawBody,this.encoding))}));break}}time(e,t=null){const s=t?new Date(t):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e}queryStr(e){let t="";for(const s in e){let i=e[s];null!=i&&""!==i&&("object"==typeof i&&(i=JSON.stringify(i)),t+=`${s}=${i}&`)}return t=t.substring(0,t.length-1),t}msg(t=e,s="",i="",o={}){const r=e=>{const{$open:t,$copy:s,$media:i,$mediaMime:o}=e;switch(typeof e){case void 0:return e;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{const r={};let a=e.openUrl||e.url||e["open-url"]||t;a&&Object.assign(r,{action:"open-url",url:a});let n=e["update-pasteboard"]||e.updatePasteboard||s;n&&Object.assign(r,{action:"clipboard",text:n});let h=e.mediaUrl||e["media-url"]||i;if(h){let e,t;if(h.startsWith("http"));else if(h.startsWith("data:")){const[s]=h.split(";"),[,i]=h.split(",");e=i,t=s.replace("data:","")}else{e=h,t=(e=>{const t={JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png","/9j/":"image/jpg"};for(var s in t)if(0===e.indexOf(s))return t[s];return null})(h)}Object.assign(r,{"media-url":h,"media-base64":e,"media-base64-mime":o??t})}return Object.assign(r,{"auto-dismiss":e["auto-dismiss"],sound:e.sound}),r}case"Loon":{const s={};let o=e.openUrl||e.url||e["open-url"]||t;o&&Object.assign(s,{openUrl:o});let r=e.mediaUrl||e["media-url"]||i;return r&&Object.assign(s,{mediaUrl:r}),console.log(JSON.stringify(s)),s}case"Quantumult X":{const o={};let r=e["open-url"]||e.url||e.openUrl||t;r&&Object.assign(o,{"open-url":r});let a=e.mediaUrl||e["media-url"]||i;a&&Object.assign(o,{"media-url":a});let n=e["update-pasteboard"]||e.updatePasteboard||s;return n&&Object.assign(o,{"update-pasteboard":n}),console.log(JSON.stringify(o)),o}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(t,s,i,r(o));break;case"Quantumult X":$notify(t,s,i,r(o));break;case"Node.js":break}if(!this.isMuteLog){let e=["","==============📣系统通知📣=============="];e.push(t),s&&e.push(s),i&&e.push(i),console.log(e.join("\n")),this.logs=this.logs.concat(e)}}debug(...e){this.logLevels[this.logLevel]<=this.logLevels.debug&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.debug}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}info(...e){this.logLevels[this.logLevel]<=this.logLevels.info&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.info}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}warn(...e){this.logLevels[this.logLevel]<=this.logLevels.warn&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.warn}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}error(...e){this.logLevels[this.logLevel]<=this.logLevels.error&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.error}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.map((e=>e??String(e))).join(this.logSeparator))}logErr(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️${this.name}, 错误!`,t,e);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,t,void 0!==e.message?e.message:e,e.stack);break}}wait(e){return new Promise((t=>setTimeout(t,e)))}done(e={}){const t=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`🔔${this.name}, 结束! 🕛 ${t} 秒`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(e);break;case"Node.js":process.exit(1)}}}(e,t)}