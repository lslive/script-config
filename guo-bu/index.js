/**
Title: Longfor ÂõΩË°•
Nomination / Category: Surge„ÄÅQuantumultX„ÄÅLoon„ÄÅShadowrocket„ÄÅNode.js
Written by: lslive
Date: 2025-09-12
Draft Version: 0.1
Contact Info: https://github.com/lslive
Notes: Âè™ÊµãËØïËøáÂúàXÔºåÂÖ∂ÂÆÉÁéØÂ¢ÉËØ∑Ëá™Ë°åÂ∞ùËØï ÁîµËßÜÂç∑ÔºåÊú™ÂºÄÂèëÂÖ∂‰ªñÂç∑ÂåÖ
*/

var _0xod8='jsjiami.com.v7';const _0x3df732=_0x2fff;(function(_0x3007cf,_0x11ad1d,_0x5d8363,_0x286ba2,_0x2fc359,_0x194ebc,_0x330090){return _0x3007cf=_0x3007cf>>0x9,_0x194ebc='hs',_0x330090='hs',function(_0x147d00,_0x3c91b6,_0x1b7d9c,_0x51ad0e,_0x90463a){const _0x36bdd0=_0x2fff;_0x51ad0e='tfi',_0x194ebc=_0x51ad0e+_0x194ebc,_0x90463a='up',_0x330090+=_0x90463a,_0x194ebc=_0x1b7d9c(_0x194ebc),_0x330090=_0x1b7d9c(_0x330090),_0x1b7d9c=0x0;const _0x378ce0=_0x147d00();while(!![]&&--_0x286ba2+_0x3c91b6){try{_0x51ad0e=-parseInt(_0x36bdd0(0x1a9,'SJ0$'))/0x1+-parseInt(_0x36bdd0(0x1b0,'MNUS'))/0x2+-parseInt(_0x36bdd0(0x1b2,'^fTM'))/0x3*(-parseInt(_0x36bdd0(0x1ca,'W$kj'))/0x4)+-parseInt(_0x36bdd0(0x1a2,'35Kb'))/0x5*(parseInt(_0x36bdd0(0x1de,'@%EQ'))/0x6)+-parseInt(_0x36bdd0(0x1c0,'j5lS'))/0x7*(parseInt(_0x36bdd0(0x19b,'@%EQ'))/0x8)+-parseInt(_0x36bdd0(0x1a5,'ggjI'))/0x9*(parseInt(_0x36bdd0(0x1b9,'^fTM'))/0xa)+parseInt(_0x36bdd0(0x1ce,'ynCs'))/0xb;}catch(_0x57d7b4){_0x51ad0e=_0x1b7d9c;}finally{_0x90463a=_0x378ce0[_0x194ebc]();if(_0x3007cf<=_0x286ba2)_0x1b7d9c?_0x2fc359?_0x51ad0e=_0x90463a:_0x2fc359=_0x90463a:_0x1b7d9c=_0x90463a;else{if(_0x1b7d9c==_0x2fc359['replace'](/[VLdInHfASyhEJDMWRQ=]/g,'')){if(_0x51ad0e===_0x3c91b6){_0x378ce0['un'+_0x194ebc](_0x90463a);break;}_0x378ce0[_0x330090](_0x90463a);}}}}}(_0x5d8363,_0x11ad1d,function(_0x120ae3,_0x2cc38c,_0x650f64,_0x203d46,_0x4aaf7b,_0xd1f9fa,_0x3a62cb){return _0x2cc38c='\x73\x70\x6c\x69\x74',_0x120ae3=arguments[0x0],_0x120ae3=_0x120ae3[_0x2cc38c](''),_0x650f64='\x72\x65\x76\x65\x72\x73\x65',_0x120ae3=_0x120ae3[_0x650f64]('\x76'),_0x203d46='\x6a\x6f\x69\x6e',(0x1bab46,_0x120ae3[_0x203d46](''));});}(0x19400,0x2ec46,_0x2819,0xcc),_0x2819)&&(_0xod8=_0x3df732(0x1d6,'ggjI'));function _0x2819(){const _0x1468c3=(function(){return[_0xod8,'EjfMsWLhjiaWVfmLAiJ.DcdyoIDmn.LQfv7RSHHW==','W5qiW6hcTsHpW6JdSSoDWPhdP8okrmoP','wSkleW','WQDwdSoC','6iYy5yYq562c5yU7fmklvJT5DEAjJ+wkLpcRVyW','FCkCW5FdJ8kxDCoXc8olW6m','oHhdKrfV','WRbGW4a','j8oWmeeHW4xdLmkEla','W4yDW5/dOxRcOH8CuMHMW5SxWOu','vvxdQNBcMa','W6/cNhtcIG','W6VcRb0faW','yCoHWPldIq3dU8o8','W57cPSoRWP1pW7Ga','W44bW5hdSq','WP3cLhiDW5u','qCoGWRBcSSkNW68+','W6hdR8o7','kqNcN1JcIa','WR8RW4/cRIm','phVdSSkieJRdMmk1A8obWPWrDv8DW6G','e8oiWQ3cVa','WQtdIt7dJha','W6Tx6i+t5yYz5As06lE3776Y6k6N6yA/5PEv6i245yYN','qCkKW53dR8kH','W5RcVfVcPte','W6LghCkbra','kCkKstNcSW','WRZcHLKIW4K','pCotmmoKWPJdRureiW'].concat((function(){return['Bd/cS8oCsMNdRCkNtCoHWR9h','W6WUWRqf','4P+2WOdOR6xMSyNMIPJLIRq+ga','sIhcJ8k6WRy','sCkMWRzeW5O','ECo+xCoLW4zHWRu','6zsr6k256iY15y6I566w5yIZWP4krZGBq+wMJEI0QW','DsDBWQKpWO5xW7bC','xfO4','W4rzE8oXeruqWQfG','W4nGW4jyWQ5eruflWPD7nG','4P6TpoIUK+AYJEAiLEwjJCkeCa','rSkuW7BdOCoyWOzFwCkgirnCda','FxRcT8k+','b8oPWOVcQSkB','W7xcKu7cGWy','W7G9W4xdSNK','W5KHWPOqWOOKW6qMtSow','WQKKWOi','WP7dTqJdUw7dKGKezNi0qsq','DczuWQKh','W6hdR8o0','WPLBWOFcVsRcUrHMqwfT','iSkyga','pCorW7xdQH1iWOW','D8o4tNFcPW','WQpdH8kmW6C4WO4xW5JcP0tdG2i','WRRcOxW+W7NdJCof','Dq9OWOrUWOZdMq','W4ZcSmkK','omkVW4pdKmkPx8oR','Deu0nCkUxLxdL8kfW4VdRCkfWPy/r8k2W7iODSkBWPfKW63cQmoLW6ddUHNdPbfjj8kBF37cHSoIWR/dVGldOq5nt8osW7DKW7b5DceQndWylmofCCkaWRWKW6KGtgjdhCkuWQmyeSkLw2pdT35XW53cN8otWQ5FWP0'].concat((function(){return['y1FdJv3cOq','FeKOW7HurmoxW7JcSaBcOt8','vmoRt8k1WRa','WPjIW4PCW41JW6SQtSo9qKa','rmo4W6KbWP8','5lUJ6zwP5lQne+wANEIJHW','EbdcQCkfW4S','i8kega','W7NcGSolWQrZWOX8WOdcMNhdK3GnW6vsW4RdHu1ZW6ldV1ZcMCkAB8otW7aMvmo5eSkAFddcUCkqW4hcR8o9W7bZW5hcQvhcRHpcULveW57cLCoybgRdV3aSbfFcMatcQSk2hCo/umksWRBdSh3cKSk1huBcMSoip2iNW7ahCSoD','W6O7WQ0qsZ8BW45CwCo9WO3cOxddJfi6mdbhW7b6W5VdNmoqc256WPdcJhVdK8oSn8oEWQBcR8kdmhW/WOdcICofCvJdGSoyydPTemkHWQGj','WP9NW4S3WPGYW64AwW','WOldPLTHW4O','b8oWWOldStVdQCkH','CCo2xSoH','W4PcFq','WOPXEYGe','B8kyW4BdTCkn','W5T8vsG9W6JcGq','W6NdJx0','W7vGEaVcLW','W5RdOSosWOC','hsBdTtvj','de7cPmoeymkSWQZcVsOqomkDWQfUWP4LW4ybWOBcVCo4WRqhFNjftMn2ge/cLszgW4LXW7CaW7WOvXeMBmoEW5SXpSoJW757cSorgbmfW7nCE0mCWOpdObRdP8oDWOVdRghdPSoyWOxdRMtdLa1NwK7dLSoZ','vCoTA8odW6W','W5u9WO4fBG','tgBcVmkPWPLSC8kRESoB','W7NcVEInG+wpIEwMIoI1GU+8OUIUOoMeIUAxSoIpVEwoHW','WO7cSCkasCosnhG','W7xcRmkMWPxcTmovWPHowa','WRddJbtdQNu','qSksW7hdRmoDW4ajr8kdnYC'];}()));}()));}());_0x2819=function(){return _0x1468c3;};return _0x2819();};const $=new Env(_0x3df732(0x1b4,'vrzm')),ckName='YSF-GB-CK';let userCookie=$[_0x3df732(0x1bb,'q^qv')](ckName);function _0x2fff(_0x4c8703,_0x55e413){const _0x281977=_0x2819();return _0x2fff=function(_0x2fff0e,_0x59b1f3){_0x2fff0e=_0x2fff0e-0x18b;let _0x22e179=_0x281977[_0x2fff0e];if(_0x2fff['BqiaBI']===undefined){var _0x3dab72=function(_0x51299b){const _0x2068e3='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x25e565='',_0xdf3478='';for(let _0x24705d=0x0,_0x3916d3,_0x385061,_0x2c99d1=0x0;_0x385061=_0x51299b['charAt'](_0x2c99d1++);~_0x385061&&(_0x3916d3=_0x24705d%0x4?_0x3916d3*0x40+_0x385061:_0x385061,_0x24705d++%0x4)?_0x25e565+=String['fromCharCode'](0xff&_0x3916d3>>(-0x2*_0x24705d&0x6)):0x0){_0x385061=_0x2068e3['indexOf'](_0x385061);}for(let _0x2c2b75=0x0,_0x349523=_0x25e565['length'];_0x2c2b75<_0x349523;_0x2c2b75++){_0xdf3478+='%'+('00'+_0x25e565['charCodeAt'](_0x2c2b75)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xdf3478);};const _0x54c23a=function(_0x9f435c,_0x134cf5){let _0x16c979=[],_0x330699=0x0,_0x1cadb5,_0x25b924='';_0x9f435c=_0x3dab72(_0x9f435c);let _0x45aaa8;for(_0x45aaa8=0x0;_0x45aaa8<0x100;_0x45aaa8++){_0x16c979[_0x45aaa8]=_0x45aaa8;}for(_0x45aaa8=0x0;_0x45aaa8<0x100;_0x45aaa8++){_0x330699=(_0x330699+_0x16c979[_0x45aaa8]+_0x134cf5['charCodeAt'](_0x45aaa8%_0x134cf5['length']))%0x100,_0x1cadb5=_0x16c979[_0x45aaa8],_0x16c979[_0x45aaa8]=_0x16c979[_0x330699],_0x16c979[_0x330699]=_0x1cadb5;}_0x45aaa8=0x0,_0x330699=0x0;for(let _0x37e315=0x0;_0x37e315<_0x9f435c['length'];_0x37e315++){_0x45aaa8=(_0x45aaa8+0x1)%0x100,_0x330699=(_0x330699+_0x16c979[_0x45aaa8])%0x100,_0x1cadb5=_0x16c979[_0x45aaa8],_0x16c979[_0x45aaa8]=_0x16c979[_0x330699],_0x16c979[_0x330699]=_0x1cadb5,_0x25b924+=String['fromCharCode'](_0x9f435c['charCodeAt'](_0x37e315)^_0x16c979[(_0x16c979[_0x45aaa8]+_0x16c979[_0x330699])%0x100]);}return _0x25b924;};_0x2fff['lpaYwK']=_0x54c23a,_0x4c8703=arguments,_0x2fff['BqiaBI']=!![];}const _0x15e52d=_0x281977[0x0],_0x250ddd=_0x2fff0e+_0x15e52d,_0x586f4e=_0x4c8703[_0x250ddd];return!_0x586f4e?(_0x2fff['REDjqc']===undefined&&(_0x2fff['REDjqc']=!![]),_0x22e179=_0x2fff['lpaYwK'](_0x22e179,_0x59b1f3),_0x4c8703[_0x250ddd]=_0x22e179):_0x22e179=_0x586f4e,_0x22e179;},_0x2fff(_0x4c8703,_0x55e413);}const urlYSF=_0x3df732(0x1b8,'[tx*');function headerData(){const _0x252e89=_0x3df732,_0x12b807={'stBfa':'Ëé∑ÂèñÁ≠æÂà∞CookieÊàêÂäüüéâ','WrWeV':_0x252e89(0x1a8,'p)^X'),'OLkTC':_0x252e89(0x1d5,'vrzm'),'nBDxU':_0x252e89(0x198,'xq*D'),'EFPxm':_0x252e89(0x1a3,'x$XL'),'MoOZz':_0x252e89(0x1e4,'vSwt'),'WOKVG':_0x252e89(0x1c9,'W$kj')};try{if(_0x12b807[_0x252e89(0x1c7,'[tx*')]!==_0x12b807[_0x252e89(0x1af,'VQjP')])_0x2f9ec0['setjson']({'token':_0xc7326c,'UserAgent':_0x403ca9,'Cookie':_0x1831b5,'channelNo':_0x2ceef7,'appNo':_0x3a461f},_0x5771ce),_0x4a39a0[_0x252e89(0x1bd,'xq*D')](_0x4e1c38['name'],'',_0x12b807['stBfa']);else return{'Content-Type':'application/json','User-Agent':userCookie[_0x12b807[_0x252e89(0x1e6,'4zpO')]],'channelNo':userCookie[_0x12b807[_0x252e89(0x18d,')w8p')]],'token':userCookie[_0x12b807['EFPxm']],'Cookie':userCookie['Cookie'],'Referer':_0x252e89(0x1ae,'oP#p'),'appNo':userCookie[_0x12b807[_0x252e89(0x1b5,'SN4Y')]]};}catch(_0x1dd799){return console['log'](_0x12b807[_0x252e89(0x1e7,'GpZb')]),{};}}function getCookie(){const _0x288621=_0x3df732,_0x559c30={'Lnkuw':'channelNo','bYYul':_0x288621(0x1d3,'UJVB'),'fOkGU':'Cookie','RcOhH':_0x288621(0x1d7,'VQjP'),'xOPTI':function(_0x9e5a8,_0x36a1ab){return _0x9e5a8!=_0x36a1ab;},'SXOAH':_0x288621(0x1db,'SJ0$'),'wTVLM':function(_0x189c2a,_0x2e5bed){return _0x189c2a===_0x2e5bed;},'EZHdJ':'TSpzb','ZWrHQ':_0x288621(0x1aa,')w8p'),'zficD':_0x288621(0x1c8,'v(5['),'QbGDi':_0x288621(0x1d1,'35Kb'),'uuZhj':function(_0x1011c6,_0x3b33a8){return _0x1011c6!==_0x3b33a8;},'OPoGI':'bVIlZ'};if($request&&_0x559c30['xOPTI']($request['method'],_0x559c30[_0x288621(0x1c4,'UJVB')])){if(_0x559c30['wTVLM'](_0x288621(0x19f,'ggjI'),_0x559c30['EZHdJ'])){const _0x3b901f=$request[_0x559c30[_0x288621(0x19e,'35Kb')]]['token'],_0x2ac796=$request[_0x559c30[_0x288621(0x1e0,'NU!$')]][_0x559c30['zficD']],_0xa8ea1c=$request[_0x559c30[_0x288621(0x192,'U7ny')]][_0x559c30['fOkGU']],_0x321079=$request[_0x559c30[_0x288621(0x18c,'UXt1')]][_0x559c30[_0x288621(0x1b3,'9dj4')]],_0x228657=$request[_0x288621(0x1ab,'%&Av')][_0x288621(0x1bf,'4zpO')];if(_0x3b901f&&_0x2ac796&&_0xa8ea1c)$[_0x288621(0x1da,'^SCQ')]({'token':_0x3b901f,'UserAgent':_0x2ac796,'Cookie':_0xa8ea1c,'channelNo':_0x321079,'appNo':_0x228657},ckName),$['msg']($[_0x288621(0x190,'[tx*')],'',_0x559c30['QbGDi']);else{if(_0x559c30[_0x288621(0x1cc,'vSwt')](_0x559c30[_0x288621(0x1dd,')w8p')],_0x559c30[_0x288621(0x1b1,'UDEj')]))try{return{'Content-Type':_0x288621(0x1e2,'#1T8'),'User-Agent':_0x134cf5[_0x288621(0x1cb,')8YH')],'channelNo':_0x16c979[_0x559c30['Lnkuw']],'token':_0x330699[_0x559c30['bYYul']],'Cookie':_0x1cadb5[_0x559c30['fOkGU']],'Referer':_0x288621(0x1b7,'SJ0$'),'appNo':_0x25b924[_0x559c30[_0x288621(0x1c2,'dY02')]]};}catch(_0x6444eb){return _0x37e315[_0x288621(0x1ac,')8YH')](_0x288621(0x1e5,'8e8U')),{};}else $[_0x288621(0x1b6,'C*6%')]($[_0x288621(0x1bc,'ky!x')],'',_0x288621(0x195,'9dj4'));}}else _0x121fe6[_0x288621(0x1a6,'C*6%')](_0x288621(0x191,'K%0M')+_0x2dc538[_0x288621(0x1d8,'GpZb')]);}$[_0x288621(0x19c,'v(5[')]();}async function couponAcquire(_0xfdd52d){const _0x35373c=_0x3df732,_0x20e6df=headerData(),_0x4d3d64='{\x22areaCode\x22:\x22610113\x22,\x22longitude\x22:\x22108.897463921441\x22,\x22latitude\x22:\x2234.26066596137153\x22,\x22acquireType\x22:\x221\x22,\x22cateCode\x22:\x22'+_0xfdd52d+_0x35373c(0x1c5,'vvAr'),_0x476d13={'url':urlYSF,'headers':_0x20e6df,'body':_0x4d3d64},_0x33138e=await $['http']['post'](_0x476d13);_0x33138e[_0x35373c(0x1d2,'4zpO')]===0xc8?$['log'](_0x35373c(0x19a,'8e8U')+_0x33138e[_0x35373c(0x1c3,'9mt0')]):$[_0x35373c(0x1a1,'xWQ(')]('‚ö†Ô∏è\x20ËØ∑Ê±ÇÂ§±Ë¥•:\x20'+_0x33138e[_0x35373c(0x1a0,'^fTM')]+'\x0a'+_0x33138e[_0x35373c(0x1dc,'ggjI')]);}(async()=>{const _0x4e8d50=_0x3df732,_0x1691c5={'snwjx':function(_0x46aa97,_0x351474){return _0x46aa97!=_0x351474;},'dqPnN':_0x4e8d50(0x196,'x$XL'),'fUFOO':_0x4e8d50(0x1cf,'UDEj'),'qFIjB':'A0403','oBPGK':_0x4e8d50(0x193,'9dj4'),'pxUEi':'A05','pNHsw':'A09','AZyNA':_0x4e8d50(0x1d4,'98Wa'),'JzXGF':_0x4e8d50(0x1c1,'FN9('),'CPRYP':function(_0x208c05,_0x314fcd){return _0x208c05<_0x314fcd;}};if(_0x1691c5['snwjx'](typeof $request,_0x1691c5['dqPnN'])){getCookie();return;}if(!userCookie){$['log']('‚ùåËØ∑ÂÖàËé∑Âèñ\x20CK'),$[_0x4e8d50(0x1d0,'&]&N')]();return;}const _0x3bb3bd=[_0x4e8d50(0x197,'%&Av'),'A02',_0x1691c5[_0x4e8d50(0x1be,'j5lS')],'A0401',_0x1691c5[_0x4e8d50(0x1ba,'K%0M')],_0x1691c5[_0x4e8d50(0x1e1,'XZCI')],_0x1691c5['pxUEi'],'A06',_0x4e8d50(0x1a4,')8YH'),_0x4e8d50(0x1df,')8YH'),_0x1691c5[_0x4e8d50(0x19d,'@%EQ')],'A10',_0x1691c5[_0x4e8d50(0x18b,'8e8U')],_0x1691c5[_0x4e8d50(0x1c6,'ky!x')]];for(let _0x582aa2=0x0;_0x1691c5[_0x4e8d50(0x1d9,'FN9(')](_0x582aa2,0xa);_0x582aa2++){for(let _0x289bf4 of _0x3bb3bd){await couponAcquire(_0x289bf4);}}})()[_0x3df732(0x194,'ky!x')](()=>{const _0x2355cb=_0x3df732;$[_0x2355cb(0x1e3,'@%EQ')]();});var version_ = 'jsjiami.com.v7';

function Env(e,t){class s{constructor(e){this.env=e}send(e,t="GET"){e="string"==typeof e?{url:e}:e;let s=this.get;"POST"===t&&(s=this.post);const i=new Promise(((t,i)=>{s.call(this,e,((e,s,o)=>{e?i(e):t(s)}))}));return e.timeout?((e,t=1e3)=>Promise.race([e,new Promise(((e,s)=>{setTimeout((()=>{s(new Error("ËØ∑Ê±ÇË∂ÖÊó∂"))}),t)}))]))(i,e.timeout):i}get(e){return this.send.call(this.env,e)}post(e){return this.send.call(this.env,e,"POST")}}return new class{constructor(e,t){this.logLevels={debug:0,info:1,warn:2,error:3},this.logLevelPrefixs={debug:"[DEBUG] ",info:"[INFO] ",warn:"[WARN] ",error:"[ERROR] "},this.logLevel="info",this.name=e,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log("",`üîî${this.name}, ÂºÄÂßã!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(e,t=null){try{return JSON.parse(e)}catch{return t}}toStr(e,t=null,...s){try{return JSON.stringify(e,...s)}catch{return t}}getjson(e,t){let s=t;if(this.getdata(e))try{s=JSON.parse(this.getdata(e))}catch{}return s}setjson(e,t){try{return this.setdata(JSON.stringify(e),t)}catch{return!1}}getScript(e){return new Promise((t=>{this.get({url:e},((e,s,i)=>t(i)))}))}runScript(e,t){return new Promise((s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let o=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");o=o?1*o:20,o=t&&t.timeout?t.timeout:o;const[r,a]=i.split("@"),n={url:`http://${a}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:o},headers:{"X-Key":r,Accept:"*/*"},policy:"DIRECT",timeout:o};this.post(n,((e,t,i)=>s(i)))})).catch((e=>this.logErr(e)))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t);if(!s&&!i)return{};{const i=s?e:t;try{return JSON.parse(this.fs.readFileSync(i))}catch(e){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t),o=JSON.stringify(this.data);s?this.fs.writeFileSync(e,o):i?this.fs.writeFileSync(t,o):this.fs.writeFileSync(e,o)}}lodash_get(e,t,s){const i=t.replace(/\[(\d+)\]/g,".$1").split(".");let o=e;for(const e of i)if(o=Object(o)[e],void 0===o)return s;return o}lodash_set(e,t,s){return Object(e)!==e||(Array.isArray(t)||(t=t.toString().match(/[^.[\]]+/g)||[]),t.slice(0,-1).reduce(((e,s,i)=>Object(e[s])===e[s]?e[s]:e[s]=Math.abs(t[i+1])>>0==+t[i+1]?[]:{}),e)[t[t.length-1]]=s),e}getdata(e){let t=this.getval(e);if(/^@/.test(e)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(e),o=s?this.getval(s):"";if(o)try{const e=JSON.parse(o);t=e?this.lodash_get(e,i,""):t}catch(e){t=""}}return t}setdata(e,t){let s=!1;if(/^@/.test(t)){const[,i,o]=/^@(.*?)\.(.*?)$/.exec(t),r=this.getval(i),a=i?"null"===r?null:r||"{}":"{}";try{const t=JSON.parse(a);this.lodash_set(t,o,e),s=this.setval(JSON.stringify(t),i)}catch(t){const r={};this.lodash_set(r,o,e),s=this.setval(JSON.stringify(r),i)}}else s=this.setval(e,t);return s}getval(e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(e);case"Quantumult X":return $prefs.valueForKey(e);case"Node.js":return this.data=this.loaddata(),this.data[e];default:return this.data&&this.data[e]||null}}setval(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(e,t);case"Quantumult X":return $prefs.setValueForKey(e,t);case"Node.js":return this.data=this.loaddata(),this.data[t]=e,this.writedata(),!0;default:return this.data&&this.data[t]||null}}initGotEnv(e){this.got=this.got?this.got:require("got").got,this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.cookie&&void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar)))}get(e,t=(()=>{})){switch(e.headers&&(delete e.headers["Content-Type"],delete e.headers["Content-Length"],delete e.headers["content-type"],delete e.headers["content-length"]),e.params&&(e.url+="?"+this.queryStr(e.params)),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(e),this.got(e).on("redirect",((e,t)=>{try{if(e.headers["set-cookie"]){const s=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),t.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>{const{statusCode:i,statusCode:o,headers:r,rawBody:a}=e,n=s.decode(a,this.encoding);t(null,{status:i,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:i,response:o}=e;t(i,o,o&&s.decode(o.rawBody,this.encoding))}));break}}post(e,t=(()=>{})){const s=e.method?e.method.toLocaleLowerCase():"post";switch(e.body&&e.headers&&!e.headers["Content-Type"]&&!e.headers["content-type"]&&(e.headers["content-type"]="application/x-www-form-urlencoded"),e.headers&&(delete e.headers["Content-Length"],delete e.headers["content-length"]),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":e.method=s,this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let i=require("iconv-lite");this.initGotEnv(e);const{url:o,...r}=e;this.got[s](o,r).then((e=>{const{statusCode:s,statusCode:o,headers:r,rawBody:a}=e,n=i.decode(a,this.encoding);t(null,{status:s,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:s,response:o}=e;t(s,o,o&&i.decode(o.rawBody,this.encoding))}));break}}time(e,t=null){const s=t?new Date(t):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e}queryStr(e){let t="";for(const s in e){let i=e[s];null!=i&&""!==i&&("object"==typeof i&&(i=JSON.stringify(i)),t+=`${s}=${i}&`)}return t=t.substring(0,t.length-1),t}msg(t=e,s="",i="",o={}){const r=e=>{const{$open:t,$copy:s,$media:i,$mediaMime:o}=e;switch(typeof e){case void 0:return e;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{const r={};let a=e.openUrl||e.url||e["open-url"]||t;a&&Object.assign(r,{action:"open-url",url:a});let n=e["update-pasteboard"]||e.updatePasteboard||s;n&&Object.assign(r,{action:"clipboard",text:n});let h=e.mediaUrl||e["media-url"]||i;if(h){let e,t;if(h.startsWith("http"));else if(h.startsWith("data:")){const[s]=h.split(";"),[,i]=h.split(",");e=i,t=s.replace("data:","")}else{e=h,t=(e=>{const t={JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png","/9j/":"image/jpg"};for(var s in t)if(0===e.indexOf(s))return t[s];return null})(h)}Object.assign(r,{"media-url":h,"media-base64":e,"media-base64-mime":o??t})}return Object.assign(r,{"auto-dismiss":e["auto-dismiss"],sound:e.sound}),r}case"Loon":{const s={};let o=e.openUrl||e.url||e["open-url"]||t;o&&Object.assign(s,{openUrl:o});let r=e.mediaUrl||e["media-url"]||i;return r&&Object.assign(s,{mediaUrl:r}),console.log(JSON.stringify(s)),s}case"Quantumult X":{const o={};let r=e["open-url"]||e.url||e.openUrl||t;r&&Object.assign(o,{"open-url":r});let a=e.mediaUrl||e["media-url"]||i;a&&Object.assign(o,{"media-url":a});let n=e["update-pasteboard"]||e.updatePasteboard||s;return n&&Object.assign(o,{"update-pasteboard":n}),console.log(JSON.stringify(o)),o}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(t,s,i,r(o));break;case"Quantumult X":$notify(t,s,i,r(o));break;case"Node.js":break}if(!this.isMuteLog){let e=["","==============üì£Á≥ªÁªüÈÄöÁü•üì£=============="];e.push(t),s&&e.push(s),i&&e.push(i),console.log(e.join("\n")),this.logs=this.logs.concat(e)}}debug(...e){this.logLevels[this.logLevel]<=this.logLevels.debug&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.debug}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}info(...e){this.logLevels[this.logLevel]<=this.logLevels.info&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.info}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}warn(...e){this.logLevels[this.logLevel]<=this.logLevels.warn&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.warn}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}error(...e){this.logLevels[this.logLevel]<=this.logLevels.error&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.error}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.map((e=>e??String(e))).join(this.logSeparator))}logErr(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`‚ùóÔ∏è${this.name}, ÈîôËØØ!`,t,e);break;case"Node.js":this.log("",`‚ùóÔ∏è${this.name}, ÈîôËØØ!`,t,void 0!==e.message?e.message:e,e.stack);break}}wait(e){return new Promise((t=>setTimeout(t,e)))}done(e={}){const t=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`üîî${this.name}, ÁªìÊùü! üïõ ${t} Áßí`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(e);break;case"Node.js":process.exit(1)}}}(e,t)}