/**
Title: Longfor ÂõΩË°•
Nomination / Category: Surge„ÄÅQuantumultX„ÄÅLoon„ÄÅShadowrocket„ÄÅNode.js
Written by: lslive
Date: 2025-7-31
Draft Version: 0.1
Contact Info: https://github.com/lslive
Notes: Âè™ÊµãËØïËøáÂúàXÔºåÂÖ∂ÂÆÉÁéØÂ¢ÉËØ∑Ëá™Ë°åÂ∞ùËØï
*/

var _0xodK='jsjiami.com.v7';const _0x5c5211=_0x10be;(function(_0x4c91ad,_0x789ff2,_0x3a24c3,_0x1d2f36,_0x3bbacd,_0x30fe79,_0x95ca51){return _0x4c91ad=_0x4c91ad>>0x8,_0x30fe79='hs',_0x95ca51='hs',function(_0xa855ac,_0x48eaa0,_0x190bd6,_0x43548a,_0x44eded){const _0x414b0e=_0x10be;_0x43548a='tfi',_0x30fe79=_0x43548a+_0x30fe79,_0x44eded='up',_0x95ca51+=_0x44eded,_0x30fe79=_0x190bd6(_0x30fe79),_0x95ca51=_0x190bd6(_0x95ca51),_0x190bd6=0x0;const _0x374655=_0xa855ac();while(!![]&&--_0x1d2f36+_0x48eaa0){try{_0x43548a=-parseInt(_0x414b0e(0x106,'[XN@'))/0x1*(parseInt(_0x414b0e(0xc7,'^bJm'))/0x2)+parseInt(_0x414b0e(0xf9,'[l[W'))/0x3*(parseInt(_0x414b0e(0xc6,'OICN'))/0x4)+parseInt(_0x414b0e(0xc9,'AQoL'))/0x5+-parseInt(_0x414b0e(0xcf,'uxbm'))/0x6+-parseInt(_0x414b0e(0xfb,'x$J&'))/0x7*(-parseInt(_0x414b0e(0xe0,'AQoL'))/0x8)+parseInt(_0x414b0e(0xed,'SsZx'))/0x9*(-parseInt(_0x414b0e(0xda,'z1ZB'))/0xa)+parseInt(_0x414b0e(0xe5,'5KRC'))/0xb*(parseInt(_0x414b0e(0xdf,'*Y8O'))/0xc);}catch(_0x45747a){_0x43548a=_0x190bd6;}finally{_0x44eded=_0x374655[_0x30fe79]();if(_0x4c91ad<=_0x1d2f36)_0x190bd6?_0x3bbacd?_0x43548a=_0x44eded:_0x3bbacd=_0x44eded:_0x190bd6=_0x44eded;else{if(_0x190bd6==_0x3bbacd['replace'](/[lrqfINUeLEXBCMkKQJ=]/g,'')){if(_0x43548a===_0x48eaa0){_0x374655['un'+_0x30fe79](_0x44eded);break;}_0x374655[_0x95ca51](_0x44eded);}}}}}(_0x3a24c3,_0x789ff2,function(_0x3153eb,_0x72a7b5,_0x5a5138,_0x52eee6,_0x557f73,_0x8d00,_0x1a84d4){return _0x72a7b5='\x73\x70\x6c\x69\x74',_0x3153eb=arguments[0x0],_0x3153eb=_0x3153eb[_0x72a7b5](''),_0x5a5138='\x72\x65\x76\x65\x72\x73\x65',_0x3153eb=_0x3153eb[_0x5a5138]('\x76'),_0x52eee6='\x6a\x6f\x69\x6e',(0x1b27ac,_0x3153eb[_0x52eee6](''));});}(0xc600,0xdabe4,_0x9b27,0xc8),_0x9b27)&&(_0xodK=_0x5c5211(0xf1,'Aa5y'));const $=new Env('‰∫ëÈó™‰ªò\x20ÂõΩË°•'),ckName=_0x5c5211(0xc1,'W$Ah');let userCookie=$['getjson'](ckName);const urlYSF=_0x5c5211(0xde,'G9Jj');function headerData(){const _0x2daefd=_0x5c5211,_0x48a308={'QVNQK':_0x2daefd(0xcd,'LhuL'),'oGSER':'channelNo','xXHYI':'appNo'};return{'Content-Type':_0x2daefd(0xc2,'#IXi'),'User-Agent':userCookie[_0x48a308[_0x2daefd(0x105,'eaol')]],'channelNo':userCookie[_0x48a308['oGSER']],'token':userCookie[_0x2daefd(0x100,'^W!D')],'Cookie':userCookie[_0x2daefd(0xe4,'Aa5y')],'Referer':_0x2daefd(0xd3,'cnSt'),'appNo':userCookie[_0x48a308[_0x2daefd(0xf3,'*Y8O')]]};}function _0x10be(_0x4a57eb,_0x231530){const _0x9b27a2=_0x9b27();return _0x10be=function(_0x10bec2,_0x3a4b9b){_0x10bec2=_0x10bec2-0xc1;let _0x337cbd=_0x9b27a2[_0x10bec2];if(_0x10be['yThOAo']===undefined){var _0x2175a1=function(_0x490a6a){const _0x596eb9='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x35df63='',_0x528299='';for(let _0x264a9b=0x0,_0x3572cf,_0x47a108,_0x41d0be=0x0;_0x47a108=_0x490a6a['charAt'](_0x41d0be++);~_0x47a108&&(_0x3572cf=_0x264a9b%0x4?_0x3572cf*0x40+_0x47a108:_0x47a108,_0x264a9b++%0x4)?_0x35df63+=String['fromCharCode'](0xff&_0x3572cf>>(-0x2*_0x264a9b&0x6)):0x0){_0x47a108=_0x596eb9['indexOf'](_0x47a108);}for(let _0x41f9cc=0x0,_0x37061b=_0x35df63['length'];_0x41f9cc<_0x37061b;_0x41f9cc++){_0x528299+='%'+('00'+_0x35df63['charCodeAt'](_0x41f9cc)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x528299);};const _0x57c747=function(_0x35ae4d,_0x4ccef2){let _0x552725=[],_0x5674bc=0x0,_0x1e1941,_0x191529='';_0x35ae4d=_0x2175a1(_0x35ae4d);let _0x1eab5a;for(_0x1eab5a=0x0;_0x1eab5a<0x100;_0x1eab5a++){_0x552725[_0x1eab5a]=_0x1eab5a;}for(_0x1eab5a=0x0;_0x1eab5a<0x100;_0x1eab5a++){_0x5674bc=(_0x5674bc+_0x552725[_0x1eab5a]+_0x4ccef2['charCodeAt'](_0x1eab5a%_0x4ccef2['length']))%0x100,_0x1e1941=_0x552725[_0x1eab5a],_0x552725[_0x1eab5a]=_0x552725[_0x5674bc],_0x552725[_0x5674bc]=_0x1e1941;}_0x1eab5a=0x0,_0x5674bc=0x0;for(let _0xe3e7f4=0x0;_0xe3e7f4<_0x35ae4d['length'];_0xe3e7f4++){_0x1eab5a=(_0x1eab5a+0x1)%0x100,_0x5674bc=(_0x5674bc+_0x552725[_0x1eab5a])%0x100,_0x1e1941=_0x552725[_0x1eab5a],_0x552725[_0x1eab5a]=_0x552725[_0x5674bc],_0x552725[_0x5674bc]=_0x1e1941,_0x191529+=String['fromCharCode'](_0x35ae4d['charCodeAt'](_0xe3e7f4)^_0x552725[(_0x552725[_0x1eab5a]+_0x552725[_0x5674bc])%0x100]);}return _0x191529;};_0x10be['ApJUXH']=_0x57c747,_0x4a57eb=arguments,_0x10be['yThOAo']=!![];}const _0x212e92=_0x9b27a2[0x0],_0x3bd165=_0x10bec2+_0x212e92,_0x59672e=_0x4a57eb[_0x3bd165];return!_0x59672e?(_0x10be['dCtcAt']===undefined&&(_0x10be['dCtcAt']=!![]),_0x337cbd=_0x10be['ApJUXH'](_0x337cbd,_0x3a4b9b),_0x4a57eb[_0x3bd165]=_0x337cbd):_0x337cbd=_0x59672e,_0x337cbd;},_0x10be(_0x4a57eb,_0x231530);}function _0x9b27(){const _0x54efbf=(function(){return[_0xodK,'lqjqNseLjiEaXMJmiK.QcJJkofBmr.NvIkX7CXrU==','bX5SqSk2WP1cWR0+','umk0WPdcP8ojmmkxaCk5we9f','W6XChSk/','t0GGgCk9cSogzSo3WPW9rmk4WRu','e8oHr1OaecJdQCkTWP7cPSoDcCoMWOyhWPKvj8k1WQGLcmouimkiWQ4HWQvNWPH/dYCJzwldP0SfW7apW6fmsqrMsH0NCeblCGm','W7RdQ8kWWOpcLvlcV8koWOG','WP3dVcddICoXhrjN','CwRcOMNdKa','W6SotCkXWQ/dOWZcSSkdsCoHvCoV','r1qUcq','WPpcIZaVWR/dVW','oqddM8kPW4JcO8kjnCokFXLv','W4ZcPt/dVq','qxeKcSk/','W7lcLCkAWQVcI8owz8kgC8kM','W5ldKfBdNCoDomkLhSkh','D3xcHeFdKa','t8kNaeuWyg7cSmky','W78kc8k9jJRdOwFcHSkRW5W+odzGWPyAemkmrNT6WOyPefpcS0G/W4LeW7JcPCkBWRtcHSkyWQSErbBdG13dHSo+W6HrWPtdUCo6WRpdHbdcJb7dQCkOWOtcN8oxWOyEkGS2o0pdJ8kYzIrNWQJdVrriW6ddGxGUEvpcJmo9q1aRW53dGhzsWP7dTSo/tJtcO8oRa20rzCkBWPHQW7faCCktWQ5jW6KdW4ddGL4SW5/cSSkWcCoYa8oLWQHzW6rVFhddHSo/ieH4sSolW5GTy27cKsBdH8kSW6RdHmkRBNnkWRNdHLNdOSktW4/dG3hcHCkaWPqViCkpz3RdSmkWAuRdPcHOj8kzW67cP8o/W6v0W5nCauz/lCoNymkfqfa9W7XKW4HKca','cSolt8orW77cHCkaWO/dGGtcLKS','WRJcGt4GWRpdQmkq','4P2h6k+b5yA16i+u5y2KCfBdSW','WQrkimokxSok','WRRcLZuTWRFdT8kkW5veDLHApHa','WRtcSKfGW5PNWPRdR8k1gSoc'].concat((function(){return['WRpcGCoiWRVcTq','W4hdUxBcS8kH','dCkTW61o','E1NcJHC','W5rqi8kFaG','W5LDWOZcRmoNDmoTrSk3W6i','W67cMCkwccehWOf8W44','faP6hSk4pSojimoe','lvnGW7DOW6VdJZldVapdGGOd','v8kMzry4W65Uv8o1W4BcJ8k6','jLpdGYFcKG','WOdcRSouWOpcTq','ExlcH8o2WRu','v1jap0a','emo8xCoiWOW','WPBcJaldMCosjSkchSkK','WP8pW7BcO8or','dmoMjf98W6yeaSorW5tcJCkyWQyUWOtcQmoQccVdQCkaW5xcMqRdUCoYdSorBdBcKsZdH8o3jeZcGttdHCksW4BcTbNdOv/cULu8oepcSSo0smoSWQGyrCkoW6fumZVcGSkpi2BcHCk3r8kbWQRcK09ckmoYaSkpdCoBB8oFWPO','gCoowmolWOm','rSodW4iQDCkQWRpcMY8','W7KZhZC0f20ZcKJdHW','6zA+6kYj6i2i5yYp56+y5yQNq8kmCSk5C0NLP6/OTBK','WPLwe8oOW7dcSa','l8oLbe5g','WR7cHtiH','wmo1WRPau3rZW6G/','W5ZdVCoAW4GwW69SDbG'].concat((function(){return['WOlcKHBdKmoDlmknd8kPemo5W7DEWQJcOvG','W6/cNCounHiSWP5U','WQO0W5pcHmoX','fCk/WQFdHmoR','qa4PBCoiWP3cUSoBW4nqWR8','bSoKW68lvSojW6hcIKlcPSk2','WQRcQCoWWO7cLuBcL8kFWQz6WPmwDe0oWOy','WPRdUwhcQCk2t1fMWQLDWRlcOCo1','cCoHnW','WOrkr3np','WRBcILhdRmktD0S','s8oubSktCmoNqCorW7i','W51/mmkikq','WRCEwSo6DMNdTelcHCk3WR1L','axxdIddcLczYp1m','WR5weSoM','W6ZdP1dcOCkc','WR4YyCkPWPPjEvHInmo1Frv0WRpdRaWkW6ddQmkWWQ57qmkIW7JdP8klW5VdOcNcKSkJjYi5W5tdI37cMSk+WQXxwCoQDhDVW5X3WRZcVmkhWOejWQxdOCo7o2T2WPqwue8zWQtdSZy9WRLhe8oWwqJdRmkMW6jUWQNdGmk5','WO7cKqe','fmktWQ0lyq','cCoqz8oiWOi','WPxdLCopW6JcKCkKnCkgwSkXsg7cUq','eCktCCokWP03WOq','WQBdQt8U'];}()));}()));}());_0x9b27=function(){return _0x54efbf;};return _0x9b27();};function getCookie(){const _0x4690f3=_0x5c5211,_0x52a59a={'YWZGj':'UserAgent','KwTaI':_0x4690f3(0xd0,'AmrQ'),'sFifJ':'token','mkISA':'appNo','PzRhq':function(_0x18f38e,_0xc1fa9b){return _0x18f38e!=_0xc1fa9b;},'GmMtp':_0x4690f3(0x103,'s@^s'),'PxIPA':'CZdQp','LJjwM':_0x4690f3(0xe8,'d*6d'),'XdKRD':'headers','OEnSV':function(_0x53868f,_0x500705){return _0x53868f&&_0x500705;},'Fcdqv':'Ëé∑ÂèñÁ≠æÂà∞CookieÊàêÂäüüéâ','cgVJY':_0x4690f3(0x108,'d*6d')};if($request&&_0x52a59a['PzRhq']($request['method'],'OPTIONS')){if(_0x52a59a['GmMtp']===_0x52a59a[_0x4690f3(0xf7,'uxbm')])return{'Content-Type':_0x4690f3(0xc8,'*Y8O'),'User-Agent':_0x264a9b[_0x52a59a[_0x4690f3(0xce,'uxbm')]],'channelNo':_0x3572cf[_0x52a59a[_0x4690f3(0xfe,'*Y8O')]],'token':_0x47a108[_0x52a59a['sFifJ']],'Cookie':_0x41d0be[_0x4690f3(0x109,'D6sa')],'Referer':_0x4690f3(0x104,'OQN5'),'appNo':_0x41f9cc[_0x52a59a[_0x4690f3(0xc4,'s@^s')]]};else{const _0x58b680=$request[_0x4690f3(0xee,'Aa5y')][_0x52a59a[_0x4690f3(0xff,'5KRC')]],_0xad82f9=$request[_0x4690f3(0xcc,'M*F5')][_0x52a59a[_0x4690f3(0xcb,'gnIH')]],_0x3e58e1=$request[_0x52a59a['XdKRD']][_0x4690f3(0xf0,'smK1')],_0x217b8b=$request[_0x52a59a['XdKRD']][_0x52a59a[_0x4690f3(0x10a,'OQN5')]],_0x397af6=$request[_0x52a59a[_0x4690f3(0x101,'eaol')]][_0x52a59a[_0x4690f3(0xc5,'TLTd')]];_0x52a59a['OEnSV'](_0x58b680,_0xad82f9)&&_0x3e58e1?($[_0x4690f3(0xd8,'MlXn')]({'token':_0x58b680,'UserAgent':_0xad82f9,'Cookie':_0x3e58e1,'channelNo':_0x217b8b,'appNo':_0x397af6},ckName),$[_0x4690f3(0xd4,'#IXi')]($[_0x4690f3(0xd9,'bJ*V')],'',_0x52a59a['Fcdqv'])):$[_0x4690f3(0xca,'OQN5')]($[_0x4690f3(0x10b,'Aa5y')],'',_0x52a59a[_0x4690f3(0xd5,'[XN@')]);}}$[_0x4690f3(0xe6,'AQoL')]();}(async()=>{const _0x3b423b=_0x5c5211,_0x30952b={'DNjyh':function(_0x54f689,_0x27b72f){return _0x54f689!=_0x27b72f;},'MMNiv':function(_0x331921){return _0x331921();},'fLNUU':function(_0x18c819,_0x34a128){return _0x18c819===_0x34a128;},'dJnzc':_0x3b423b(0xd2,'[6Xz'),'AHqRJ':function(_0x5af372,_0x5e8e72,_0x365db7){return _0x5af372(_0x5e8e72,_0x365db7);}};if(_0x30952b[_0x3b423b(0xfd,'AmrQ')](typeof $request,_0x3b423b(0x102,'#IXi'))){getCookie();return;}if(!userCookie)return $['log'](_0x3b423b(0xef,'x)hl'));const _0x98958f=_0x30952b[_0x3b423b(0xe1,'8Wtf')](headerData),_0x4ce58b=_0x3b423b(0xec,'uxbm'),_0x10f466={'url':urlYSF,'headers':_0x98958f,'body':_0x4ce58b},_0x790d33=await $[_0x3b423b(0xdc,'uxbm')][_0x3b423b(0xf6,'x)hl')](_0x10f466);return _0x790d33[_0x3b423b(0xf8,'T^0m')]===0xc8?$['log']('‚úÖ\x20ËØ∑Ê±ÇÊàêÂäü:\x20'+_0x790d33[_0x3b423b(0xe3,'2VTK')]):_0x30952b[_0x3b423b(0xf4,'[6Xz')](_0x3b423b(0xea,'8Wtf'),_0x30952b[_0x3b423b(0xe7,'2VTK')])?$['log']('‚ö†Ô∏è\x20ËØ∑Ê±ÇÂ§±Ë¥•:\x20'+_0x790d33['statusCode']+'\x0a'+_0x790d33[_0x3b423b(0xe3,'2VTK')]):_0x3a235c[_0x3b423b(0xf5,'vBcg')](),await _0x30952b[_0x3b423b(0xd6,'eaol')](httpRequest,_0x10f466,'post');})()['finally'](async()=>{const _0x5aec4c=_0x5c5211;$[_0x5aec4c(0xd1,'D6sa')]();});var version_ = 'jsjiami.com.v7';

function Env(e,t){class s{constructor(e){this.env=e}send(e,t="GET"){e="string"==typeof e?{url:e}:e;let s=this.get;"POST"===t&&(s=this.post);const i=new Promise(((t,i)=>{s.call(this,e,((e,s,o)=>{e?i(e):t(s)}))}));return e.timeout?((e,t=1e3)=>Promise.race([e,new Promise(((e,s)=>{setTimeout((()=>{s(new Error("ËØ∑Ê±ÇË∂ÖÊó∂"))}),t)}))]))(i,e.timeout):i}get(e){return this.send.call(this.env,e)}post(e){return this.send.call(this.env,e,"POST")}}return new class{constructor(e,t){this.logLevels={debug:0,info:1,warn:2,error:3},this.logLevelPrefixs={debug:"[DEBUG] ",info:"[INFO] ",warn:"[WARN] ",error:"[ERROR] "},this.logLevel="info",this.name=e,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log("",`üîî${this.name}, ÂºÄÂßã!`)}getEnv(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":void 0}isNode(){return"Node.js"===this.getEnv()}isQuanX(){return"Quantumult X"===this.getEnv()}isSurge(){return"Surge"===this.getEnv()}isLoon(){return"Loon"===this.getEnv()}isShadowrocket(){return"Shadowrocket"===this.getEnv()}isStash(){return"Stash"===this.getEnv()}toObj(e,t=null){try{return JSON.parse(e)}catch{return t}}toStr(e,t=null,...s){try{return JSON.stringify(e,...s)}catch{return t}}getjson(e,t){let s=t;if(this.getdata(e))try{s=JSON.parse(this.getdata(e))}catch{}return s}setjson(e,t){try{return this.setdata(JSON.stringify(e),t)}catch{return!1}}getScript(e){return new Promise((t=>{this.get({url:e},((e,s,i)=>t(i)))}))}runScript(e,t){return new Promise((s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let o=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");o=o?1*o:20,o=t&&t.timeout?t.timeout:o;const[r,a]=i.split("@"),n={url:`http://${a}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:o},headers:{"X-Key":r,Accept:"*/*"},policy:"DIRECT",timeout:o};this.post(n,((e,t,i)=>s(i)))})).catch((e=>this.logErr(e)))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t);if(!s&&!i)return{};{const i=s?e:t;try{return JSON.parse(this.fs.readFileSync(i))}catch(e){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const e=this.path.resolve(this.dataFile),t=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(e),i=!s&&this.fs.existsSync(t),o=JSON.stringify(this.data);s?this.fs.writeFileSync(e,o):i?this.fs.writeFileSync(t,o):this.fs.writeFileSync(e,o)}}lodash_get(e,t,s){const i=t.replace(/\[(\d+)\]/g,".$1").split(".");let o=e;for(const e of i)if(o=Object(o)[e],void 0===o)return s;return o}lodash_set(e,t,s){return Object(e)!==e||(Array.isArray(t)||(t=t.toString().match(/[^.[\]]+/g)||[]),t.slice(0,-1).reduce(((e,s,i)=>Object(e[s])===e[s]?e[s]:e[s]=Math.abs(t[i+1])>>0==+t[i+1]?[]:{}),e)[t[t.length-1]]=s),e}getdata(e){let t=this.getval(e);if(/^@/.test(e)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(e),o=s?this.getval(s):"";if(o)try{const e=JSON.parse(o);t=e?this.lodash_get(e,i,""):t}catch(e){t=""}}return t}setdata(e,t){let s=!1;if(/^@/.test(t)){const[,i,o]=/^@(.*?)\.(.*?)$/.exec(t),r=this.getval(i),a=i?"null"===r?null:r||"{}":"{}";try{const t=JSON.parse(a);this.lodash_set(t,o,e),s=this.setval(JSON.stringify(t),i)}catch(t){const r={};this.lodash_set(r,o,e),s=this.setval(JSON.stringify(r),i)}}else s=this.setval(e,t);return s}getval(e){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.read(e);case"Quantumult X":return $prefs.valueForKey(e);case"Node.js":return this.data=this.loaddata(),this.data[e];default:return this.data&&this.data[e]||null}}setval(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":return $persistentStore.write(e,t);case"Quantumult X":return $prefs.setValueForKey(e,t);case"Node.js":return this.data=this.loaddata(),this.data[t]=e,this.writedata(),!0;default:return this.data&&this.data[t]||null}}initGotEnv(e){this.got=this.got?this.got:require("got").got,this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.cookie&&void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar)))}get(e,t=(()=>{})){switch(e.headers&&(delete e.headers["Content-Type"],delete e.headers["Content-Length"],delete e.headers["content-type"],delete e.headers["content-length"]),e.params&&(e.url+="?"+this.queryStr(e.params)),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let s=require("iconv-lite");this.initGotEnv(e),this.got(e).on("redirect",((e,t)=>{try{if(e.headers["set-cookie"]){const s=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),t.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>{const{statusCode:i,statusCode:o,headers:r,rawBody:a}=e,n=s.decode(a,this.encoding);t(null,{status:i,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:i,response:o}=e;t(i,o,o&&s.decode(o.rawBody,this.encoding))}));break}}post(e,t=(()=>{})){const s=e.method?e.method.toLocaleLowerCase():"post";switch(e.body&&e.headers&&!e.headers["Content-Type"]&&!e.headers["content-type"]&&(e.headers["content-type"]="application/x-www-form-urlencoded"),e.headers&&(delete e.headers["Content-Length"],delete e.headers["content-length"]),void 0===e.followRedirect||e.followRedirect||((this.isSurge()||this.isLoon())&&(e["auto-redirect"]=!1),this.isQuanX()&&(e.opts?e.opts.redirection=!1:e.opts={redirection:!1})),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:this.isSurge()&&this.isNeedRewrite&&(e.headers=e.headers||{},Object.assign(e.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](e,((e,s,i)=>{!e&&s&&(s.body=i,s.statusCode=s.status?s.status:s.statusCode,s.status=s.statusCode),t(e,s,i)}));break;case"Quantumult X":e.method=s,this.isNeedRewrite&&(e.opts=e.opts||{},Object.assign(e.opts,{hints:!1})),$task.fetch(e).then((e=>{const{statusCode:s,statusCode:i,headers:o,body:r,bodyBytes:a}=e;t(null,{status:s,statusCode:i,headers:o,body:r,bodyBytes:a},r,a)}),(e=>t(e&&e.error||"UndefinedError")));break;case"Node.js":let i=require("iconv-lite");this.initGotEnv(e);const{url:o,...r}=e;this.got[s](o,r).then((e=>{const{statusCode:s,statusCode:o,headers:r,rawBody:a}=e,n=i.decode(a,this.encoding);t(null,{status:s,statusCode:o,headers:r,rawBody:a,body:n},n)}),(e=>{const{message:s,response:o}=e;t(s,o,o&&i.decode(o.rawBody,this.encoding))}));break}}time(e,t=null){const s=t?new Date(t):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e}queryStr(e){let t="";for(const s in e){let i=e[s];null!=i&&""!==i&&("object"==typeof i&&(i=JSON.stringify(i)),t+=`${s}=${i}&`)}return t=t.substring(0,t.length-1),t}msg(t=e,s="",i="",o={}){const r=e=>{const{$open:t,$copy:s,$media:i,$mediaMime:o}=e;switch(typeof e){case void 0:return e;case"string":switch(this.getEnv()){case"Surge":case"Stash":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.getEnv()){case"Surge":case"Stash":case"Shadowrocket":default:{const r={};let a=e.openUrl||e.url||e["open-url"]||t;a&&Object.assign(r,{action:"open-url",url:a});let n=e["update-pasteboard"]||e.updatePasteboard||s;n&&Object.assign(r,{action:"clipboard",text:n});let h=e.mediaUrl||e["media-url"]||i;if(h){let e,t;if(h.startsWith("http"));else if(h.startsWith("data:")){const[s]=h.split(";"),[,i]=h.split(",");e=i,t=s.replace("data:","")}else{e=h,t=(e=>{const t={JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png","/9j/":"image/jpg"};for(var s in t)if(0===e.indexOf(s))return t[s];return null})(h)}Object.assign(r,{"media-url":h,"media-base64":e,"media-base64-mime":o??t})}return Object.assign(r,{"auto-dismiss":e["auto-dismiss"],sound:e.sound}),r}case"Loon":{const s={};let o=e.openUrl||e.url||e["open-url"]||t;o&&Object.assign(s,{openUrl:o});let r=e.mediaUrl||e["media-url"]||i;return r&&Object.assign(s,{mediaUrl:r}),console.log(JSON.stringify(s)),s}case"Quantumult X":{const o={};let r=e["open-url"]||e.url||e.openUrl||t;r&&Object.assign(o,{"open-url":r});let a=e.mediaUrl||e["media-url"]||i;a&&Object.assign(o,{"media-url":a});let n=e["update-pasteboard"]||e.updatePasteboard||s;return n&&Object.assign(o,{"update-pasteboard":n}),console.log(JSON.stringify(o)),o}case"Node.js":return}default:return}};if(!this.isMute)switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":default:$notification.post(t,s,i,r(o));break;case"Quantumult X":$notify(t,s,i,r(o));break;case"Node.js":break}if(!this.isMuteLog){let e=["","==============üì£Á≥ªÁªüÈÄöÁü•üì£=============="];e.push(t),s&&e.push(s),i&&e.push(i),console.log(e.join("\n")),this.logs=this.logs.concat(e)}}debug(...e){this.logLevels[this.logLevel]<=this.logLevels.debug&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.debug}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}info(...e){this.logLevels[this.logLevel]<=this.logLevels.info&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.info}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}warn(...e){this.logLevels[this.logLevel]<=this.logLevels.warn&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.warn}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}error(...e){this.logLevels[this.logLevel]<=this.logLevels.error&&(e.length>0&&(this.logs=[...this.logs,...e]),console.log(`${this.logLevelPrefixs.error}${e.map((e=>e??String(e))).join(this.logSeparator)}`))}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.map((e=>e??String(e))).join(this.logSeparator))}logErr(e,t){switch(this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:this.log("",`‚ùóÔ∏è${this.name}, ÈîôËØØ!`,t,e);break;case"Node.js":this.log("",`‚ùóÔ∏è${this.name}, ÈîôËØØ!`,t,void 0!==e.message?e.message:e,e.stack);break}}wait(e){return new Promise((t=>setTimeout(t,e)))}done(e={}){const t=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`üîî${this.name}, ÁªìÊùü! üïõ ${t} Áßí`),this.log(),this.getEnv()){case"Surge":case"Loon":case"Stash":case"Shadowrocket":case"Quantumult X":default:$done(e);break;case"Node.js":process.exit(1)}}}(e,t)}